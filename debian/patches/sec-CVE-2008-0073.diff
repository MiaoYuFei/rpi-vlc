diff -Nurad vlc-0.8.6.c.orig/modules/access/rtsp/real_sdpplin.c vlc-0.8.6.c/modules/access/rtsp/real_sdpplin.c
--- vlc-0.8.6.c.orig/modules/access/rtsp/real_sdpplin.c	2008-03-28 14:17:49.000000000 +0100
+++ vlc-0.8.6.c/modules/access/rtsp/real_sdpplin.c	2008-03-28 14:20:51.000000000 +0100
@@ -138,7 +138,14 @@
     handled=0;
 
     if(filter(*data,"a=control:streamid=",&buf, BUFLEN)) {
-      desc->stream_id=atoi(buf);
+      /* This way negative values are mapped to unfeasibly high
+       * values, and will be discarded afterward
+       */
+      unsigned long tmp = strtoul(buf, NULL, 10);
+      if ( tmp > UINT16_MAX )
+        lprintf("stream id out of bound: %lu\n", tmp);
+      else
+        desc->stream_id=tmp;
       handled=1;
       *data=nl(*data);
     }
@@ -245,7 +252,10 @@
     if (filter(data, "m=", &buf, BUFLEN)) {
       stream=sdpplin_parse_stream(&data);
       lprintf("got data for stream id %u\n", stream->stream_id);
-      desc->stream[stream->stream_id]=stream;
+      if ( stream->stream_id >= desc->stream_count )
+        lprintf("stream id %u is greater than stream count %u\n", stream->stream_id, desc->stream_count);
+      else
+        desc->stream[stream->stream_id]=stream;
       continue;
     }
     if(filter(data,"a=Title:buffer;",&buf, BUFLEN)) {
@@ -273,7 +283,14 @@
       data=nl(data);
     }
     if(filter(data,"a=StreamCount:integer;",&buf, BUFLEN)) {
-      desc->stream_count=atoi(buf);
+      /* This way negative values are mapped to unfeasibly high
+       * values, and will be discarded afterward
+       */
+      unsigned long tmp = strtoul(buf, NULL, 10);
+      if ( tmp > UINT16_MAX )
+        lprintf("stream count out of bound: %lu\n", tmp);
+      else
+        desc->stream_count = tmp;
       desc->stream = malloc(sizeof(sdpplin_stream_t*)*desc->stream_count);
       handled=1;
       data=nl(data);
diff -Nurad vlc-0.8.6.c.orig/modules/access/rtsp/real_sdpplin.h vlc-0.8.6.c/modules/access/rtsp/real_sdpplin.h
--- vlc-0.8.6.c.orig/modules/access/rtsp/real_sdpplin.h	2008-03-28 14:17:49.000000000 +0100
+++ vlc-0.8.6.c/modules/access/rtsp/real_sdpplin.h	2008-03-28 14:21:13.000000000 +0100
@@ -31,7 +31,7 @@
   char *id;
   char *bandwidth;
 
-  int stream_id;
+  uint16_t stream_id;
   char *range;
   char *length;
   char *rtpmap;
@@ -75,7 +75,7 @@
 
   int flags;
   int is_real_data_type;
-  int stream_count;
+  uint16_t stream_count;
   char *title;
   char *author;
   char *copyright;
